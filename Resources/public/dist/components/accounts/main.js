define(["accountsutil/header","sulucontact/components/accounts/main"],function(a,b){"use strict";var c,d=function(){},e=function(){},f=function(a){g.call(this,function(b){b&&(this.account.set({type:a.id}),this.sandbox.emit("sulu.header.toolbar.item.loading","options-button"),this.sandbox.util.ajax("/admin/api/accounts/"+this.account.id+"?action=convertAccountType&type="+a.name,{type:"POST",success:function(a){var b=a;this.sandbox.emit("sulu.header.toolbar.item.enable","options-button"),this.sandbox.emit("sulu.contacts.accounts.saved",b),this.setHeader(),this.sandbox.emit("sulu.account.type.converted")}.bind(this),error:function(){this.sandbox.logger.log("error while saving profile")}.bind(this)}))}.bind(this))},g=function(a){if(a&&"function"!=typeof a)throw"callback is not a function";this.sandbox.emit("sulu.overlay.show-warning","sulu.overlay.be-careful","contact.accounts.type.conversion.message",a.bind(this,!1),a.bind(this,!0))};return d.prototype=b,d.prototype.constructor=d,c=new d,e.prototype=new d,e.prototype.constructor=e,e.prototype.accountType=null,e.prototype.accountTypes=null,e.prototype.bindCustomEvents=function(){c.bindCustomEvents.call(this),this.sandbox.on("sulu.contacts.account.types",function(a){this.accountType=a.accountType,this.accountTypes=a.accountTypes}.bind(this)),this.sandbox.on("sulu.contacts.account.get.types",function(a){"function"==typeof a&&a(this.accountType,this.accountTypes)}.bind(this)),this.sandbox.on("sulu.contacts.account.convert",function(a){f.call(this,a)}.bind(this))},e.prototype.renderList=function(){var a=this.sandbox.dom.createElement('<div id="accounts-list-container"/>');this.html(a),this.sandbox.start([{name:"accounts/components/list@sulucontact",options:{el:a,accountType:this.options.accountType?this.options.accountType:null}}])},e.prototype.setHeader=function(){a.setHeader.call(this,this.account,this.options.accountType)},e.prototype.renderCreateForm=function(b,c){var d=a.getAccountTypeIdByTypeName.call(this,this.options.accountType);this.account.set({type:d}),this.sandbox.start([{name:"accounts/components/form@sulucontact",options:{el:c,data:this.account.toJSON()}}]),b.resolve()},e.prototype.add=function(a){this.sandbox.emit("sulu.router.navigate","contacts/accounts/add/type:"+a)},new e});