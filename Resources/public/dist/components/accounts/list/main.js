define(["mvc/relationalstore","app-config","sulucontact/components/accounts/list/main","services/sulucontactextension/account-router","services/sulucontactextension/account-header","services/sulucontact/contact-router"],function(a,b,c,d,e,f){"use strict";var g,h={datagridInstanceName:"accounts"},i=function(){},j=function(){},k="",l=function(){var a,c,d,e,f,g,h,i=b.getSection("sulu-contact-extension");if(!i||!i.hasOwnProperty("accountTypes")||i.accountTypes.length<1)return!1;f=i.accountTypes,a=[{id:"all",name:this.sandbox.translate("public.all")}];for(d in f)"basic"!==d&&(e=f[d],a.push({id:parseInt(e.id,10),name:this.sandbox.translate(e.translation),key:e.name}));if(this.options.accountType){for(c in f)if(c.toLowerCase()===this.options.accountType.toLowerCase()){g=f[c];break}if(!g)throw"accountType "+g+" does not exist!";k+="&type="+g.id}return h=g?parseInt(g.id,10)+1:!1,{componentOptions:{callback:m.bind(this),preselector:"position",preselect:h},data:a}},m=function(a){var b=null,c="contacts/accounts";"all"!==a.id&&(b=a.id,c+="/type:"+a.key.toLowerCase()),this.sandbox.emit("husky.datagrid."+h.datagridInstanceName+".url.update",{type:b}),this.sandbox.emit("sulu.router.navigate",c,!1)},n=function(a){d.toAdd({type:a})},o=function(a){this.sandbox.emit("sulu.sidebar.set-widget","/admin/widget-groups/account-info?account="+a)};return i.prototype=c,i.prototype.constructor=i,g=new i,j.prototype=new i,j.prototype.constructor=j,j.prototype.layout=function(){var a=g.layout;return a.sidebar={width:"fixed",cssClasses:"sidebar-padding-50"},a},j.prototype.header=function(){var a=g.header,b=!1,c=l.call(this);return a.title="contact.accounts.title",c&&(b={data:c.data,componentOptions:c.componentOptions}),a.tabs=b,a.toolbar.buttons.add=this.sandbox.util.extend(!0,{},a.toolbar.buttons.add,{options:{dropdownItems:[{id:"add-basic",title:this.sandbox.translate("contact.account.add-basic"),callback:n.bind(this,e.getAccountTypeIdByTypeName("basic"))},{id:"add-lead",title:this.sandbox.translate("contact.account.add-lead"),callback:n.bind(this,e.getAccountTypeIdByTypeName("lead"))},{id:"add-customer",title:this.sandbox.translate("contact.account.add-customer"),callback:n.bind(this,e.getAccountTypeIdByTypeName("customer"))},{id:"add-supplier",title:this.sandbox.translate("contact.account.add-supplier"),callback:n.bind(this,e.getAccountTypeIdByTypeName("supplier"))}]}}),a},j.prototype.initialize=function(){g.initialize.call(this),this.sandbox.dom.off("#sidebar"),this.sandbox.dom.on("#sidebar","click",function(a){var b=this.sandbox.dom.data(a.currentTarget,"id");d.toEdit(b)}.bind(this),"#sidebar-accounts-list"),this.sandbox.dom.on("#sidebar","click",function(a){var b=this.sandbox.dom.data(a.currentTarget,"id");f.toEdit(b)}.bind(this),"#main-contact"),this.sandbox.dom.on("#sidebar","click",function(a){var b=this.sandbox.dom.data(a.currentTarget,"id");d.toEdit(b)}.bind(this),".subsidiary-account")},j.prototype.getDatagridConfig=function(){var a,c=g.getDatagridConfig.call(this),d="",e=b.getSection("sulu-contact-extension").accountTypes,f={};for(var h in e)f[e[h].id]=e[h],this.options.accountType&&h.toLowerCase()===this.options.accountType.toLowerCase()&&(a=e[h]);if(this.options.accountType){if(!a)throw"accountType "+a+" does not exist!";d+="&type="+a.id}return c.url=c.url+d,c.clickCallback=o.bind(this),c.contentFilters={type:function(a){return a?this.sandbox.translate(f[a].translation):""}.bind(this)},c},new j});