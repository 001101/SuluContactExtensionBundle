define(["mvc/relationalstore","app-config","sulucontact/components/accounts/components/list/main"],function(a,b,c){"use strict";var d,e=function(){},f=function(){},g="",h=function(){var a,c,d,e,f,h,j,k=b.getSection("sulu-contact-extension");if(!k||!k.hasOwnProperty("accountTypes")||k.accountTypes.length<1)return!1;f=k.accountTypes,a=[{id:"all",name:this.sandbox.translate("public.all")}];for(d in f)"basic"!==d&&(e=f[d],a.push({id:parseInt(e.id,10),name:this.sandbox.translate(e.translation)}));if(this.options.accountType){for(c in f)if(c.toLowerCase()===this.options.accountType.toLowerCase()){h=f[c];break}if(!h)throw"accountType "+h+" does not exist!";g+="&type="+h.id}return j=h?parseInt(h.id,10)+1:!1,{callback:i.bind(this),preselector:"position",data:a,preselect:j}},i=function(a){var b=null;"all"!==a.id&&(b=a.id),this.sandbox.emit("husky.datagrid.url.update",{type:b}),this.sandbox.emit("sulu.contacts.accounts.list",a.name,!0)},j=function(a){this.sandbox.emit("sulu.contacts.accounts.new",a)};return e.prototype=c,e.prototype.constructor=e,d=new e,f.prototype=new e,f.prototype.constructor=f,f.prototype.header=function(){var a=d.header.call(this),b=!1,c=h.call(this);return c&&(b={fullControl:!0,options:c}),a.tabs=b,a},f.prototype.getToolbarTemplate=function(){var a=d.getToolbarTemplate.call(this);return a[0].items=[{id:"add-basic",title:this.sandbox.translate("contact.account.add-basic"),callback:j.bind(this,"basic")},{id:"add-lead",title:this.sandbox.translate("contact.account.add-lead"),callback:j.bind(this,"lead")},{id:"add-customer",title:this.sandbox.translate("contact.account.add-customer"),callback:j.bind(this,"customer")},{id:"add-supplier",title:this.sandbox.translate("contact.account.add-supplier"),callback:j.bind(this,"supplier")}],a},f.prototype.render=function(){a.reset(),this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/account/list"));var c,d,e="",f=b.getSection("sulu-contact-extension").accountTypes,g={};for(c in f)g[f[c].id]=f[c],this.options.accountType&&c.toLowerCase()===this.options.accountType.toLowerCase()&&(d=f[c]);if(this.options.accountType){if(!d)throw"accountType "+d+" does not exist!";e+="&type="+d.id}this.sandbox.sulu.initListToolbarAndList.call(this,"accounts","/admin/api/accounts/fields",{el:this.$find("#list-toolbar-container"),instanceName:"accounts",parentTemplate:"default",inHeader:!0,template:function(){return this.getToolbarTemplate()}.bind(this)},{el:this.sandbox.dom.find("#companies-list",this.$el),url:"/admin/api/accounts?flat=true"+e,resultKey:"accounts",searchInstanceName:"accounts",searchFields:["name"],contentFilters:{type:function(a){return a?this.sandbox.translate(g[a].translation):""}.bind(this)},viewOptions:{table:{icons:[{icon:"pencil",column:"name",align:"left",callback:function(a){this.sandbox.emit("sulu.contacts.accounts.load",a)}.bind(this)}],highlightSelected:!0,fullWidth:!0}}})},new f});