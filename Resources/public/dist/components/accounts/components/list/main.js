define(["mvc/relationalstore","app-config","sulucontact/components/accounts/components/list/main"],function(a,b,c){"use strict";var d,e={datagridInstanceName:"accounts"},f=function(){},g=function(){},h="",i=function(){var a,c,d,e,f,g,i,k=b.getSection("sulu-contact-extension");if(!k||!k.hasOwnProperty("accountTypes")||k.accountTypes.length<1)return!1;f=k.accountTypes,a=[{id:"all",name:this.sandbox.translate("public.all")}];for(d in f)"basic"!==d&&(e=f[d],a.push({id:parseInt(e.id,10),name:this.sandbox.translate(e.translation)}));if(this.options.accountType){for(c in f)if(c.toLowerCase()===this.options.accountType.toLowerCase()){g=f[c];break}if(!g)throw"accountType "+g+" does not exist!";h+="&type="+g.id}return i=g?parseInt(g.id,10)+1:!1,{callback:j.bind(this),preselector:"position",data:a,preselect:i}},j=function(a){var b=null;"all"!==a.id&&(b=a.id),this.sandbox.emit("husky.datagrid."+e.datagridInstanceName+".url.update",{type:b}),this.sandbox.emit("sulu.contacts.accounts.list",a.name,!0)},k=function(a){this.sandbox.emit("sulu.contacts.accounts.new",a)};return f.prototype=c,f.prototype.constructor=f,d=new f,g.prototype=new f,g.prototype.constructor=g,g.prototype.header=function(){var a=d.header.call(this),b=!1,c=i.call(this);return c&&(b={fullControl:!0,options:c}),a.tabs=b,a},g.prototype.getToolbarTemplate=function(){var a=d.getToolbarTemplate.call(this);return a[0].items=[{id:"add-basic",title:this.sandbox.translate("contact.account.add-basic"),callback:k.bind(this,"basic")},{id:"add-lead",title:this.sandbox.translate("contact.account.add-lead"),callback:k.bind(this,"lead")},{id:"add-customer",title:this.sandbox.translate("contact.account.add-customer"),callback:k.bind(this,"customer")},{id:"add-supplier",title:this.sandbox.translate("contact.account.add-supplier"),callback:k.bind(this,"supplier")}],a},g.prototype.render=function(){a.reset(),this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/account/list"));var c,d,f="",g=b.getSection("sulu-contact-extension").accountTypes,h={};for(c in g)h[g[c].id]=g[c],this.options.accountType&&c.toLowerCase()===this.options.accountType.toLowerCase()&&(d=g[c]);if(this.options.accountType){if(!d)throw"accountType "+d+" does not exist!";f+="&type="+d.id}this.sandbox.sulu.initListToolbarAndList.call(this,"accounts","/admin/api/accounts/fields",{el:this.$find("#list-toolbar-container"),instanceName:"accounts",parentTemplate:"default",inHeader:!0,groups:[{id:1,align:"left"},{id:2,align:"right"}],template:function(){return this.getToolbarTemplate()}.bind(this)},{el:this.sandbox.dom.find("#companies-list",this.$el),url:"/admin/api/accounts?flat=true"+f,resultKey:"accounts",searchInstanceName:"accounts",searchFields:["name"],instanceName:e.datagridInstanceName,contentFilters:{type:function(a){return a?this.sandbox.translate(h[a].translation):""}.bind(this)},viewOptions:{table:{icons:[{icon:"pencil",column:"name",align:"left",callback:function(a){this.sandbox.emit("sulu.contacts.accounts.load",a)}.bind(this)}],highlightSelected:!0,fullWidth:!0}}},"accounts","#companies-list-info")},new g});