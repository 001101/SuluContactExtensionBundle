define(["mvc/relationalstore","app-config","sulucontact/components/accounts/components/list/main","widget-groups"],function(a,b,c,d){"use strict";var e,f={datagridInstanceName:"accounts"},g=function(){},h=function(){},i="",j=function(){var a,c,d,e,f,g,h,j=b.getSection("sulu-contact-extension");if(!j||!j.hasOwnProperty("accountTypes")||j.accountTypes.length<1)return!1;f=j.accountTypes,a=[{id:"all",name:this.sandbox.translate("public.all")}];for(d in f)"basic"!==d&&(e=f[d],a.push({id:parseInt(e.id,10),name:this.sandbox.translate(e.translation)}));if(this.options.accountType){for(c in f)if(c.toLowerCase()===this.options.accountType.toLowerCase()){g=f[c];break}if(!g)throw"accountType "+g+" does not exist!";i+="&type="+g.id}return h=g?parseInt(g.id,10)+1:!1,{callback:k.bind(this),preselector:"position",data:a,preselect:h}},k=function(a){var b=null;"all"!==a.id&&(b=a.id),this.sandbox.emit("husky.datagrid."+f.datagridInstanceName+".url.update",{type:b}),this.sandbox.emit("sulu.contacts.accounts.list",a.name,!0)},l=function(a){this.sandbox.emit("sulu.contacts.accounts.new",a)},m=function(a){this.sandbox.emit("sulu.sidebar.set-widget","/admin/widget-groups/account-info?account="+a)},n=function(a){this.sandbox.emit("sulu.contacts.accounts.load",a)};return g.prototype=c,g.prototype.constructor=g,e=new g,h.prototype=new g,h.prototype.constructor=h,h.prototype.header=function(){var a=e.header.call(this),b=!1,c=j.call(this);return c&&(b={fullControl:!0,options:c}),a.tabs=b,a},h.prototype.getToolbarTemplate=function(){var a=e.getToolbarTemplate.call(this);return a[0].items=[{id:"add-basic",title:this.sandbox.translate("contact.account.add-basic"),callback:l.bind(this,"basic")},{id:"add-lead",title:this.sandbox.translate("contact.account.add-lead"),callback:l.bind(this,"lead")},{id:"add-customer",title:this.sandbox.translate("contact.account.add-customer"),callback:l.bind(this,"customer")},{id:"add-supplier",title:this.sandbox.translate("contact.account.add-supplier"),callback:l.bind(this,"supplier")}],a},h.prototype.render=function(){a.reset(),this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/account/list"));var c,e,g="",h=b.getSection("sulu-contact-extension").accountTypes,i={};for(c in h)i[h[c].id]=h[c],this.options.accountType&&c.toLowerCase()===this.options.accountType.toLowerCase()&&(e=h[c]);if(this.options.accountType){if(!e)throw"accountType "+e+" does not exist!";g+="&type="+e.id}this.sandbox.sulu.initListToolbarAndList.call(this,"accounts","/admin/api/accounts/fields",{el:this.$find("#list-toolbar-container"),instanceName:"accounts",parentTemplate:"default",inHeader:!0,groups:[{id:1,align:"left"},{id:2,align:"right"}],template:function(){return this.getToolbarTemplate()}.bind(this)},{el:this.sandbox.dom.find("#companies-list",this.$el),url:"/admin/api/accounts?flat=true"+g,resultKey:"accounts",searchInstanceName:"accounts",searchFields:["name"],instanceName:f.datagridInstanceName,contentFilters:{type:function(a){return a?this.sandbox.translate(i[a].translation):""}.bind(this)},clickCallback:d.exists("account-info")?m.bind(this):null,actionCallback:n.bind(this)},"accounts","#companies-list-info")},new h});