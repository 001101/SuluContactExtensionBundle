define(["sulucontact/components/contacts/list/main","services/sulucontactextension/contact-router","app-config"],function(a,b,c){"use strict";var d,e=function(){},f=function(){},g="",h={datagridInstanceName:"contacts"},i=function(){var a,b,d,e,f,h,i,j=c.getSection("sulu-contact-extension");if(!j||!j.hasOwnProperty("contactTypes")||j.contactTypes.length<1)return!1;f=j.contactTypes,a=[{id:"all",name:this.sandbox.translate("public.all")}];for(d in f)"basic"!==d&&(e=f[d],a.push({id:parseInt(e.id,10),name:this.sandbox.translate(e.translation),key:e.name}));if(this.options.contactType){for(b in f)if(b.toLowerCase()===this.options.contactType.toLowerCase()){h=f[b];break}if(!h)throw"contactType "+h+" does not exist!";g+="&type="+h.id}return i=h?parseInt(h.id,10)+1:!1,{componentOptions:{callback:k.bind(this),preselector:"position",preselect:i},data:a}},j=function(a){b.toAdd({type:a})},k=function(a){var b=null,c="contacts/contacts";"all"!==a.id&&(b=a.id,c+="/type:"+a.key.toLowerCase()),this.sandbox.emit("husky.datagrid."+h.datagridInstanceName+".url.update",{type:b}),this.sandbox.emit("sulu.router.navigate",c,!1)},l=function(a){this.sandbox.emit("sulu.sidebar.set-widget","/admin/widget-groups/contact-info?contact="+a)};return e.prototype=a,e.prototype.constructor=e,d=new e,f.prototype=new e,f.prototype.constructor=f,f.prototype.layout=function(){var a=d.layout;return a.sidebar={width:"fixed",cssClasses:"sidebar-padding-50"},a},f.prototype.initialize=function(){d.initialize.call(this),this.sandbox.dom.off("#sidebar"),this.sandbox.dom.on("#sidebar","click",function(a){var c=this.sandbox.dom.data(a.currentTarget,"id");b.toEdit(c)}.bind(this),"#sidebar-contact-list"),this.sandbox.dom.on("#sidebar","click",function(a){var c=this.sandbox.dom.data(a.currentTarget,"id");b.toEdit(c)}.bind(this),"#main-account")},f.prototype.getDatagridConfig=function(){var a=d.getDatagridConfig.call(this);return a.clickCallback=l.bind(this),a},f.prototype.header=function(){var a=d.header,b=!1,e=i.call(this);a.title="contact.contacts.title",e&&(b={data:e.data,componentOptions:e.componentOptions}),a.tabs=b;var f=[],g=c.getSection("sulu-contact-extension").contactTypes;return this.sandbox.util.each(g,function(a,b){f.push({id:b.id,title:this.sandbox.translate(b.addTranslation),callback:j.bind(this,b.name)})}.bind(this)),f.length>0&&(a.toolbar.buttons.add=this.sandbox.util.extend(!0,{},a.toolbar.buttons.add,{options:{dropdownItems:f}})),a},f.prototype.getDatagridConfig=function(){var a,b=d.getDatagridConfig.call(this),e="",f=c.getSection("sulu-contact-extension").contactTypes,g={};for(var h in f)g[f[h].id]=f[h],this.options.contactType&&h.toLowerCase()===this.options.contactType.toLowerCase()&&(a=f[h]);if(this.options.contactType){if(!a)throw"contactType "+a+" does not exist!";e+="&type="+a.id}return b.url=b.url+e,b.clickCallback=l.bind(this),b.contentFilters={type:function(a){return a?this.sandbox.translate(g[a].translation):""}.bind(this)},b},new f});